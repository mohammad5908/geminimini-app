<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#000000">
    <title>Gemini Store</title>

    <style>
        body { background-color: #000; margin: 0; padding: 0; font-family: sans-serif; overflow-x: hidden; }
        #app-loader { position: fixed; inset: 0; z-index: 9999; background: #000; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s; }
        .pulse-ring { width: 50px; height: 50px; border-radius: 50%; border: 2px solid #8b5cf6; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(0.8); opacity: 1; } 100% { transform: scale(1.5); opacity: 0; } }
        .logo-text { color: #8b5cf6; margin-top: 20px; letter-spacing: 4px; font-size: 12px; font-weight: bold; }
        [v-cloak] { display: none !important; }
    </style>
</head>
<body>

    <div id="app-loader">
        <div class="pulse-ring"></div>
        <div class="logo-text">GEMINI LOADING...</div>
    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Vazirmatn', 'sans-serif'] },
                    colors: {
                        deep: '#050505',
                        glass: 'rgba(255, 255, 255, 0.08)',
                        glass_active: 'rgba(255, 255, 255, 0.15)',
                        primary: '#8b5cf6', // Ø¨Ù†ÙØ´ Ø¬Ù…ÛŒÙ†Ø§ÛŒ
                        accent: '#ec4899',  // ØµÙˆØ±ØªÛŒ
                        gold: '#fbbf24'     // Ø·Ù„Ø§ÛŒÛŒ
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-10px)' } }
                    }
                }
            }
        }
    </script>

    <style>
        /* Glassmorphism */
        .glass-card {
            background: linear-gradient(180deg, rgba(30,30,30,0.6) 0%, rgba(10,10,10,0.9) 100%);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.08);
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.5);
        }
        
        /* Ø¯Ú©Ù…Ù‡ Ú¯Ø±Ø§Ø¯ÛŒØ§Ù†Øª */
        .btn-main {
            background: linear-gradient(135deg, #7c3aed 0%, #db2777 100%);
            box-shadow: 0 4px 15px rgba(124, 58, 237, 0.4);
            transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .btn-main:active { transform: scale(0.96); opacity: 0.9; }

        /* ÙÙˆÙ†Øª Ø§Ø¹Ø¯Ø§Ø¯ ÙØ§Ø±Ø³ÛŒ/Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ */
        .num-font { font-feature-settings: "ss01"; }
        
        /* Ø­Ø°Ù Ù‡Ø§ÛŒÙ„Ø§ÛŒØª Ø¢Ø¨ÛŒ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
        * { -webkit-tap-highlight-color: transparent; }
        
        /* Safe Area (Ø¨Ø±Ø§ÛŒ Ø¢ÛŒÙÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ù†Ø§Ú†â€ŒØ¯Ø§Ø±) */
        .safe-top { padding-top: env(safe-area-inset-top); }
        .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
    </style>

    <div id="app" v-cloak class="min-h-screen text-white pb-10 safe-top">
        
        <div class="fixed inset-0 z-[-1] overflow-hidden pointer-events-none">
            <div class="absolute top-[-10%] right-[-20%] w-[300px] h-[300px] bg-primary/20 rounded-full blur-[100px] animate-float"></div>
            <div class="absolute bottom-[-10%] left-[-10%] w-[250px] h-[250px] bg-accent/10 rounded-full blur-[80px] animate-float" style="animation-delay: 2s;"></div>
        </div>

        <div class="max-w-md mx-auto px-5 pt-6">
            
            <header class="flex items-center justify-between mb-8 animate-[fadeIn_0.5s]">
                <div class="flex items-center gap-3">
                    <div class="relative">
                        <img :src="user.photo_url || 'https://cdn-icons-png.flaticon.com/512/149/149071.png'" class="w-12 h-12 rounded-full border-2 border-white/10 object-cover bg-white/5">
                        <div class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-black rounded-full"></div>
                    </div>
                    <div>
                        <h1 class="font-bold text-lg leading-tight">{{ user.first_name }}</h1>
                        <p class="text-[10px] text-primary uppercase tracking-widest font-bold mt-1">Premium Member</p>
                    </div>
                </div>
                <div class="w-10 h-10 rounded-full glass-card flex items-center justify-center">
                    <i class="fa-solid fa-bell text-white/50"></i>
                </div>
            </header>

            <div @click="openModal('gemini_ultra_monthly_ready')" class="glass-card rounded-[32px] p-6 mb-6 relative overflow-hidden group cursor-pointer border border-primary/30 active:scale-[0.98] transition-transform">
                <div class="absolute -right-6 -top-6 w-32 h-32 bg-primary/20 rounded-full blur-[40px]"></div>
                
                <div class="relative z-10">
                    <div class="flex justify-between items-start mb-3">
                        <span class="bg-white/10 backdrop-blur px-2 py-1 rounded-lg text-[9px] font-bold border border-white/10">TOP RATED</span>
                        <i class="fa-solid fa-rocket text-2xl text-white/20 group-hover:text-white/60 transition-colors"></i>
                    </div>
                    <h2 class="text-3xl font-black mb-1">Gemini <span class="text-transparent bg-clip-text bg-gradient-to-r from-primary to-accent">Ultra</span></h2>
                    <p class="text-xs text-white/60 mb-5 leading-relaxed max-w-[80%]">
                        Ù‚Ø¯Ø±ØªÙ…Ù†Ø¯ØªØ±ÛŒÙ† Ù…Ø¯Ù„ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ú¯ÙˆÚ¯Ù„. ØªØ­Ù„ÛŒÙ„ ØªØµÙˆÛŒØ±ØŒ Ú©Ø¯Ù†ÙˆÛŒØ³ÛŒ Ùˆ Ø³Ø±Ø¹Øª Ø¨Ø§Ù„Ø§.
                    </p>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex flex-col">
                            <span class="text-[10px] text-white/30 line-through">2,500,000</span>
                            <span class="text-xl font-bold text-gold num-font">
                                {{ formatPrice(getProduct('gemini_ultra_monthly_ready').price) }} 
                                <span class="text-[10px] font-normal text-white/50">ØªÙˆÙ…Ø§Ù†</span>
                            </span>
                        </div>
                        <button class="w-10 h-10 rounded-full bg-white text-black flex items-center justify-center hover:scale-110 transition-transform shadow-lg">
                            <i class="fa-solid fa-arrow-left -rotate-45"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="space-y-4">
                <div class="flex items-center gap-2 mb-2 px-1 opacity-70">
                    <i class="fa-solid fa-layer-group text-xs"></i>
                    <h3 class="text-xs font-bold">Ø³Ø§ÛŒØ± Ø§Ø´ØªØ±Ø§Ú©â€ŒÙ‡Ø§</h3>
                </div>

                <div v-for="p in regularProducts" :key="p.id" @click="openModal(p.id)"
                     class="glass-card rounded-2xl p-4 flex items-center gap-4 cursor-pointer active:scale-[0.98] transition-transform hover:bg-glass_active">
                    
                    <div class="w-14 h-14 rounded-xl flex items-center justify-center text-2xl bg-white/5 border border-white/5 shadow-inner">
                        {{ p.emoji }}
                    </div>
                    
                    <div class="flex-1">
                        <h3 class="font-bold text-sm text-white">{{ p.name }}</h3>
                        <p class="text-[10px] text-white/40 mt-1">{{ p.desc }}</p>
                    </div>
                    
                    <div class="text-left">
                        <div class="text-gold font-bold text-base num-font">{{ formatPrice(p.price) }}</div>
                        <div class="text-[9px] text-white/30">ØªÙˆÙ…Ø§Ù†</div>
                    </div>
                </div>
            </div>

        </div>

        <transition name="slide">
            <div v-if="modal.show" class="fixed inset-0 z-50 flex items-end justify-center sm:items-center" @click.self="closeModal">
                <div class="absolute inset-0 bg-black/80 backdrop-blur-sm transition-opacity"></div>
                
                <div class="relative w-full max-w-md bg-[#121212] border-t border-white/10 rounded-t-[32px] sm:rounded-[32px] p-6 shadow-2xl animate-[slideUp_0.3s_ease-out]">
                    <div class="w-12 h-1.5 bg-white/10 rounded-full mx-auto mb-6"></div>
                    
                    <div class="text-center mb-6">
                        <div class="w-20 h-20 mx-auto rounded-2xl bg-white/5 flex items-center justify-center text-5xl mb-4 border border-white/5 shadow-[0_0_30px_rgba(139,92,246,0.1)]">
                            {{ modal.product.emoji }}
                        </div>
                        <h2 class="text-xl font-black text-white">{{ modal.product.name }}</h2>
                        <div class="inline-block mt-2 px-3 py-1 rounded bg-white/5 text-[10px] text-white/50 border border-white/5">{{ modal.product.desc }}</div>
                    </div>

                    <div class="grid grid-cols-2 gap-3 mb-6">
                        <div class="bg-white/5 rounded-xl p-3 flex items-center gap-2 border border-white/5">
                            <i class="fa-solid fa-bolt text-gold text-xs"></i>
                            <span class="text-[10px] text-white/70">ØªØ­ÙˆÛŒÙ„ Ø¢Ù†ÛŒ</span>
                        </div>
                        <div class="bg-white/5 rounded-xl p-3 flex items-center gap-2 border border-white/5">
                            <i class="fa-solid fa-shield text-primary text-xs"></i>
                            <span class="text-[10px] text-white/70">Ø¶Ù…Ø§Ù†Øª Ú©Ø§Ù…Ù„</span>
                        </div>
                    </div>

                    <div class="flex justify-between items-center mb-4 px-1">
                        <span class="text-xs text-white/50">Ù…Ø¨Ù„Øº Ù†Ù‡Ø§ÛŒÛŒ:</span>
                        <span class="text-xl font-bold text-gold num-font">{{ formatPrice(modal.product.price) }} <span class="text-xs font-normal">ØªÙˆÙ…Ø§Ù†</span></span>
                    </div>

                    <button @click="buyProduct" :disabled="sending" class="w-full py-4 rounded-xl btn-main text-white font-bold text-sm flex items-center justify-center gap-2 disabled:opacity-50 disabled:grayscale">
                        <span v-if="!sending">ØªØ§ÛŒÛŒØ¯ Ùˆ Ù¾Ø±Ø¯Ø§Ø®Øª Ø¢Ù†Ù„Ø§ÛŒÙ†</span>
                        <span v-else class="w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"></span>
                    </button>
                    
                    <p class="text-[9px] text-center text-white/20 mt-4 font-mono">SECURED BY TELEGRAM PAYMENT</p>
                </div>
            </div>
        </transition>

    </div>

    <script>
        const { createApp, ref, computed, onMounted } = Vue;

        createApp({
            setup() {
                const user = ref({ first_name: 'Guest', id: '---' });
                const modal = ref({ show: false, product: {} });
                const sending = ref(false);

                // Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ù…Ø­ØµÙˆÙ„Ø§Øª (Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ù‡Ù…Ø§Ù‡Ù†Ú¯ Ø¨Ø§ Config.PRICES Ù¾Ø§ÛŒØªÙˆÙ†)
                const products = ref([
                    { id: 'gemini_pro_monthly_ready', name: 'Gemini Pro Ù…Ø§Ù‡Ø§Ù†Ù‡', desc: 'Ø§Ú©Ø§Ù†Øª Ø¢Ù…Ø§Ø¯Ù‡ â€¢ Û³Û° Ø±ÙˆØ²Ù‡', price: 380000, emoji: 'ğŸ’' },
                    { id: 'gemini_pro_yearly_ready', name: 'Gemini Pro Ø³Ø§Ù„Ø§Ù†Ù‡', desc: 'Ø§Ú©Ø§Ù†Øª Ø¢Ù…Ø§Ø¯Ù‡ â€¢ ÛŒÚ©Ø³Ø§Ù„Ù‡', price: 1280000, emoji: 'ğŸ‘‘' },
                    { id: 'gemini_pro_monthly_personal', name: 'Ø´Ø§Ø±Ú˜ Ø§ÛŒÙ…ÛŒÙ„ Ø´Ø®ØµÛŒ', desc: 'ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø±ÙˆÛŒ Ø§Ú©Ø§Ù†Øª Ø´Ù…Ø§', price: 300000, emoji: 'ğŸ“§' },
                    { id: 'gemini_ultra_monthly_ready', name: 'Gemini Ultra', desc: 'Ù¾Ø±Ù‚Ø¯Ø±Øªâ€ŒØªØ±ÛŒÙ† Ù…Ø¯Ù„ Ú¯ÙˆÚ¯Ù„', price: 1850000, emoji: 'ğŸš€' }
                ]);

                // Ø¬Ø¯Ø§ Ú©Ø±Ø¯Ù† Ù…Ø­ØµÙˆÙ„ ÙˆÛŒÚ˜Ù‡ (Ultra) Ø§Ø² Ù„ÛŒØ³Øª Ø¹Ø§Ø¯ÛŒ
                const regularProducts = computed(() => products.value.filter(p => p.id !== 'gemini_ultra_monthly_ready'));

                // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ
                onMounted(() => {
                    setTimeout(() => {
                        // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù„ÙˆØ¯ÛŒÙ†Ú¯
                        document.getElementById('app-loader').style.opacity = '0';
                        setTimeout(() => document.getElementById('app-loader').style.display = 'none', 500);
                    }, 800);

                    try {
                        const tg = window.Telegram.WebApp;
                        tg.expand();
                        tg.setHeaderColor('#000000');
                        tg.setBackgroundColor('#000000');
                        tg.enableClosingConfirmation();

                        if (tg.initDataUnsafe?.user) {
                            user.value = tg.initDataUnsafe.user;
                        }

                        // Ø¢Ù¾Ø¯ÛŒØª Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ Ø§Ø² Ù„ÛŒÙ†Ú© (Ø§Ú¯Ø± ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯)
                        const params = new URLSearchParams(window.location.search);
                        products.value.forEach(p => {
                            if (params.has(p.id)) p.price = parseInt(params.get(p.id));
                        });

                    } catch (e) {
                        console.log("Telegram API not available");
                    }
                });

                // ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ
                const formatPrice = (n) => Number(n).toLocaleString();
                const getProduct = (id) => products.value.find(p => p.id === id);

                const openModal = (id) => {
                    const p = getProduct(id);
                    if (p) {
                        modal.value = { show: true, product: p };
                        if (window.Telegram.WebApp.HapticFeedback) 
                            window.Telegram.WebApp.HapticFeedback.impactOccurred('light');
                    }
                };

                const closeModal = () => modal.value.show = false;

                // ØªØ§Ø¨Ø¹ Ù†Ù‡Ø§ÛŒÛŒ Ø®Ø±ÛŒØ¯
                const buyProduct = () => {
                    sending.value = true;
                    const tg = window.Telegram.WebApp;

                    // ÙˆÛŒØ¨Ø±Ù‡ Ù…ÙˆÙÙ‚ÛŒØª
                    if (tg.HapticFeedback) tg.HapticFeedback.notificationOccurred('success');

                    setTimeout(() => {
                        try {
                            // Ø§Ø±Ø³Ø§Ù„ Ø´Ù†Ø§Ø³Ù‡ Ø¨Ù‡ Ø±Ø¨Ø§Øª
                            tg.sendData(modal.value.product.id);
                        } catch (e) {
                            alert("Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø±Ø¨Ø§Øª. Ù„Ø·ÙØ§Ù‹ Ù…Ø¬Ø¯Ø¯ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.");
                            sending.value = false;
                        }
                    }, 500);
                };

                return {
                    user, modal, sending, products, regularProducts,
                    formatPrice, getProduct, openModal, closeModal, buyProduct
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
